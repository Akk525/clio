<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clio Badge System - Test Frontend</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      color: white;
      margin-bottom: 40px;
      padding: 30px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      backdrop-filter: blur(10px);
    }

    .header h1 {
      font-size: 3em;
      margin-bottom: 10px;
    }

    .header p {
      font-size: 1.2em;
      opacity: 0.9;
    }

    .warning {
      background: #ff6b6b;
      color: white;
      padding: 15px 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      text-align: center;
      font-weight: bold;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      transition: transform 0.2s;
    }

    .card:hover {
      transform: translateY(-5px);
    }

    .card h2 {
      color: #667eea;
      margin-bottom: 15px;
      font-size: 1.5em;
    }

    .badge-item {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 15px;
      border-radius: 10px;
      margin: 10px 0;
    }

    .badge-item h3 {
      margin-bottom: 5px;
      font-size: 1.1em;
    }

    .badge-item p {
      font-size: 0.9em;
      opacity: 0.9;
    }

    .badge-item .meta {
      font-size: 0.8em;
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid rgba(255, 255, 255, 0.3);
    }

    .stat-box {
      text-align: center;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 10px;
      margin: 10px 0;
    }

    .stat-box .number {
      font-size: 3em;
      font-weight: bold;
      display: block;
    }

    .stat-box .label {
      font-size: 1em;
      opacity: 0.9;
      display: block;
      margin-top: 5px;
    }

    .search-box {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .search-box input {
      width: 100%;
      padding: 15px;
      border: 2px solid #667eea;
      border-radius: 8px;
      font-size: 1em;
      margin-top: 10px;
    }

    .search-box button {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
      transition: opacity 0.2s;
    }

    .search-box button:hover {
      opacity: 0.9;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: white;
      font-size: 1.2em;
    }

    .error {
      background: #ff6b6b;
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
    }

    .leader-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      margin: 10px 0;
      border-left: 4px solid #667eea;
    }

    .leader-rank {
      font-size: 2em;
      font-weight: bold;
      color: #667eea;
      min-width: 50px;
    }

    .leader-address {
      flex: 1;
      font-family: monospace;
      font-size: 0.9em;
    }

    .leader-count {
      font-size: 1.5em;
      font-weight: bold;
      color: #764ba2;
    }

    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .tab {
      padding: 12px 24px;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      transition: all 0.2s;
    }

    .tab:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .tab.active {
      background: white;
      color: #667eea;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .supporter-item {
      padding: 12px;
      background: #f8f9fa;
      border-radius: 8px;
      margin: 8px 0;
    }

    .supporter-address {
      font-family: monospace;
      font-weight: bold;
      margin-bottom: 8px;
    }

    .supporter-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .mini-badge {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.85em;
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #666;
      font-size: 1.2em;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1>üé® Clio Badge System</h1>
      <p>Temporary Testing Frontend - Verify Everything Works!</p>
    </div>

    <!-- Warning Banner -->
    <div class="warning">
      ‚ö†Ô∏è TEMPORARY FRONTEND FOR TESTING ONLY - NOT THE FINAL UI ‚ö†Ô∏è
    </div>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab active" onclick="showTab('stats')">üìä Stats</button>
      <button class="tab" onclick="showTab('leaderboard')">üèÜ Leaderboard</button>
      <button class="tab" onclick="showTab('profile')">üë§ Profile</button>
      <button class="tab" onclick="showTab('artist')">üé® Artist</button>
      <button class="tab" onclick="showTab('test')">üß™ Test Data</button>
    </div>

    <!-- Stats Tab -->
    <div id="stats-tab" class="tab-content active">
      <div class="grid">
        <div class="stat-box">
          <span class="number" id="total-artists">-</span>
          <span class="label">Artists</span>
        </div>
        <div class="stat-box">
          <span class="number" id="total-holders">-</span>
          <span class="label">Holders</span>
        </div>
        <div class="stat-box">
          <span class="number" id="total-badges">-</span>
          <span class="label">Badges Awarded</span>
        </div>
        <div class="stat-box">
          <span class="number" id="total-users">-</span>
          <span class="label">Badge Collectors</span>
        </div>
      </div>

      <div class="card">
        <h2>Badge Distribution</h2>
        <div id="badge-distribution"></div>
      </div>
    </div>

    <!-- Leaderboard Tab -->
    <div id="leaderboard-tab" class="tab-content">
      <div class="card">
        <h2>üèÜ Top Badge Collectors</h2>
        <div id="leaderboard-list"></div>
      </div>
    </div>

    <!-- Profile Tab -->
    <div id="profile-tab" class="tab-content">
      <div class="search-box">
        <h2>Search User Profile</h2>
        <input 
          type="text" 
          id="profile-address" 
          placeholder="Enter wallet address (0x...)"
          value="0xmuselover1234567890123456789012345678901"
        >
        <button onclick="loadProfile()">Search Profile</button>
      </div>

      <div id="profile-results"></div>
    </div>

    <!-- Artist Tab -->
    <div id="artist-tab" class="tab-content">
      <div class="search-box">
        <h2>Search Artist Supporters</h2>
        <input 
          type="number" 
          id="artist-id" 
          placeholder="Enter artist ID"
          value="100"
        >
        <button onclick="loadArtistSupporters()">Search Artist</button>
      </div>

      <div id="artist-results"></div>
    </div>

    <!-- Test Data Tab -->
    <div id="test-tab" class="tab-content">
      <div class="card">
        <h2>üß™ Test Data Overview</h2>
        <p style="margin-bottom: 20px;">Available test addresses and IDs you can query:</p>
        
        <h3 style="margin: 20px 0 10px 0; color: #667eea;">Test Users:</h3>
        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 0.9em;">
          <div style="margin: 5px 0;">0xmuselover1234567890123456789012345678901 (17 badges)</div>
          <div style="margin: 5px 0;">0xpromethean1000000000000000000000000000000 (2 badges)</div>
          <div style="margin: 5px 0;">0xtitanwhale123456789012345678901234567890 (1 badge)</div>
          <div style="margin: 5px 0;">0xdipbuyer1234567890123456789012345678901 (1 badge)</div>
        </div>

        <h3 style="margin: 20px 0 10px 0; color: #667eea;">Test Artist IDs:</h3>
        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
          <div style="margin: 5px 0;">100 - Test Artist (electronic)</div>
          <div style="margin: 5px 0;">200 - Pop Artist</div>
          <div style="margin: 5px 0;">201 - Rap Artist</div>
          <div style="margin: 5px 0;">999 - Artist 999 (from indexer test)</div>
        </div>

        <h3 style="margin: 20px 0 10px 0; color: #667eea;">Quick Actions:</h3>
        <button onclick="loadProfile('0xmuselover1234567890123456789012345678901')" 
                style="margin: 5px; padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer;">
          Load Top User Profile
        </button>
        <button onclick="loadArtistSupporters('100')" 
                style="margin: 5px; padding: 10px 20px; background: #764ba2; color: white; border: none; border-radius: 5px; cursor: pointer;">
          Load Artist 100 Supporters
        </button>
      </div>
    </div>
  </div>

  <script>
    const API_BASE = 'http://localhost:3000/api'

    // Tab switching
    function showTab(tabName) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active')
      })
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active')
      })

      // Show selected tab
      document.getElementById(`${tabName}-tab`).classList.add('active')
      event.target.classList.add('active')

      // Load data for tab
      if (tabName === 'stats') loadStats()
      if (tabName === 'leaderboard') loadLeaderboard()
    }

    // Load stats
    async function loadStats() {
      try {
        const response = await fetch(`${API_BASE}/stats`)
        const data = await response.json()

        document.getElementById('total-artists').textContent = data.totalArtists
        document.getElementById('total-holders').textContent = data.totalHolders
        document.getElementById('total-badges').textContent = data.totalBadgesAwarded
        document.getElementById('total-users').textContent = data.totalUsers

        const distributionHTML = data.badgeDistribution
          .map(badge => `
            <div class="badge-item">
              <h3>${badge.displayName}</h3>
              <p>${badge.count} awarded</p>
            </div>
          `)
          .join('')

        document.getElementById('badge-distribution').innerHTML = distributionHTML
      } catch (error) {
        console.error('Error loading stats:', error)
        document.getElementById('badge-distribution').innerHTML = 
          '<div class="error">Error loading stats. Make sure Next.js server is running (npm run dev)</div>'
      }
    }

    // Load leaderboard
    async function loadLeaderboard() {
      try {
        const response = await fetch(`${API_BASE}/leaderboard?limit=10`)
        const data = await response.json()

        const leaderboardHTML = data
          .map((user, i) => `
            <div class="leader-item">
              <div class="leader-rank">#${i + 1}</div>
              <div class="leader-address">${user.userAddress}</div>
              <div class="leader-count">${user.totalBadges} üèÜ</div>
            </div>
          `)
          .join('')

        document.getElementById('leaderboard-list').innerHTML = 
          leaderboardHTML || '<div class="empty-state">No data yet</div>'
      } catch (error) {
        console.error('Error loading leaderboard:', error)
        document.getElementById('leaderboard-list').innerHTML = 
          '<div class="error">Error loading leaderboard</div>'
      }
    }

    // Load profile
    async function loadProfile(address = null) {
      const addr = address || document.getElementById('profile-address').value
      
      if (!addr) {
        alert('Please enter a wallet address')
        return
      }

      // Switch to profile tab if not already there
      if (!address) {
        showTab('profile')
      }

      document.getElementById('profile-results').innerHTML = '<div class="loading">Loading...</div>'

      try {
        // Load badges
        const badgesResponse = await fetch(`${API_BASE}/profile/${addr}/badges`)
        const badges = await badgesResponse.json()

        // Load full profile
        const profileResponse = await fetch(`${API_BASE}/profile/${addr}`)
        const profile = await profileResponse.json()

        if (badgesResponse.ok && profileResponse.ok) {
          const badgesHTML = badges.length > 0 
            ? badges.map(badge => `
                <div class="badge-item">
                  <h3>${badge.displayName}</h3>
                  <p>${badge.description}</p>
                  ${badge.artistName ? `<p>üé® ${badge.artistName}</p>` : '<p>üåç Global Badge</p>'}
                  <div class="meta">
                    Awarded: ${new Date(badge.awardedAt).toLocaleString()}
                    ${badge.meta ? `<br>Meta: ${JSON.stringify(badge.meta)}` : ''}
                  </div>
                </div>
              `).join('')
            : '<div class="empty-state">No badges yet</div>'

          const artistsHTML = profile.artists.length > 0
            ? profile.artists.map(artist => `
                <div style="padding: 10px; background: #f8f9fa; border-radius: 8px; margin: 5px 0;">
                  <strong>${artist.name}</strong> ${artist.handle}
                  ${artist.genre ? ` - ${artist.genre}` : ''}
                </div>
              `).join('')
            : '<div class="empty-state">No artists supported yet</div>'

          document.getElementById('profile-results').innerHTML = `
            <div class="card">
              <h2>üë§ ${addr.substring(0, 10)}...${addr.substring(addr.length - 8)}</h2>
              <p style="margin: 10px 0; color: #666;">
                Supporting ${profile.artists.length} artists ‚Ä¢ ${profile.badges.length} badges earned
              </p>
            </div>

            <div class="card">
              <h2>üé® Artists Supported (${profile.artists.length})</h2>
              ${artistsHTML}
            </div>

            <div class="card">
              <h2>üèÜ Badges Earned (${badges.length})</h2>
              ${badgesHTML}
            </div>
          `
        } else {
          throw new Error('API returned error')
        }
      } catch (error) {
        console.error('Error loading profile:', error)
        document.getElementById('profile-results').innerHTML = 
          '<div class="error">Error loading profile. Check console for details.</div>'
      }
    }

    // Load artist supporters
    async function loadArtistSupporters(artistId = null) {
      const id = artistId || document.getElementById('artist-id').value
      
      if (!id) {
        alert('Please enter an artist ID')
        return
      }

      // Switch to artist tab if not already there
      if (!artistId) {
        showTab('artist')
      }

      document.getElementById('artist-results').innerHTML = '<div class="loading">Loading...</div>'

      try {
        const response = await fetch(`${API_BASE}/artists/${id}/supporters`)
        const supporters = await response.json()

        if (response.ok) {
          const supportersHTML = supporters.length > 0
            ? supporters.map(supporter => `
                <div class="supporter-item">
                  <div class="supporter-address">
                    ${supporter.userAddress.substring(0, 12)}...${supporter.userAddress.substring(supporter.userAddress.length - 8)}
                  </div>
                  <div class="supporter-badges">
                    ${supporter.badges.length > 0 
                      ? supporter.badges.map(b => `<span class="mini-badge">${b.displayName}</span>`).join('')
                      : '<span style="color: #999;">No badges</span>'
                    }
                  </div>
                </div>
              `).join('')
            : '<div class="empty-state">No supporters yet</div>'

          document.getElementById('artist-results').innerHTML = `
            <div class="card">
              <h2>üé® Artist ${id} - Supporters</h2>
              <p style="margin: 10px 0; color: #666;">
                ${supporters.length} total supporters
              </p>
              ${supportersHTML}
            </div>
          `
        } else {
          throw new Error(supporters.error || 'Unknown error')
        }
      } catch (error) {
        console.error('Error loading supporters:', error)
        document.getElementById('artist-results').innerHTML = 
          `<div class="error">Error: ${error.message}</div>`
      }
    }

    // Initialize on load
    window.onload = function() {
      loadStats()
      console.log('üé® Clio Badge System - Temporary Frontend Loaded')
      console.log('Make sure Next.js server is running: npm run dev')
    }
  </script>
</body>
</html>

